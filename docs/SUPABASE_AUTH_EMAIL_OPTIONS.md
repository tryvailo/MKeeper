# Supabase Auth: –í–∞—Ä–∏–∞–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Email

**–î–∞—Ç–∞:** –Ø–Ω–≤–∞—Ä—å 2025  
**–ü—Ä–æ–¥—É–∫—Ç:** Memory Keeper  
**–°—Ç–∞—Ç—É—Å:** –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–µ—Ç–æ–¥–∞–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

## ‚úÖ –û–ë–©–ò–ô –û–¢–í–ï–¢

**–î–∞, Supabase Auth –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ email!**

–î–æ—Å—Ç—É–ø–Ω—ã **3 –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–∞** –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ email:

1. **Email + Password** (—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π)
2. **Magic Link** (passwordless - –±–µ–∑ –ø–∞—Ä–æ–ª—è)
3. **OTP (One-Time Password)** (passwordless - –∫–æ–¥ –∏–∑ 6 —Ü–∏—Ñ—Ä)

–í—Å–µ –º–µ—Ç–æ–¥—ã –≤–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ **free tier**.

---

## üìß –ú–ï–¢–û–î 1: EMAIL + PASSWORD

### –û–ø–∏—Å–∞–Ω–∏–µ
–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∞–∫–∫–∞—É–Ω—Ç —Å email –∏ –ø–∞—Ä–æ–ª–µ–º, –∑–∞—Ç–µ–º –≤—Ö–æ–¥–∏—Ç –∏—Å–ø–æ–ª—å–∑—É—è —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ü—Ä–∏–≤—ã—á–Ω—ã–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ email –¥–ª—è –≤—Ö–æ–¥–∞
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω (–ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞)
- ‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—Å–µ—Ö –≤–æ–∑—Ä–∞—Å—Ç–æ–≤ (–≤–∞–∂–Ω–æ –¥–ª—è Memory Keeper)

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–º–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
- ‚ö†Ô∏è –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è "–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å"
- ‚ö†Ô∏è –ú–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ (—Ä–∏—Å–∫ —É—Ç–µ—á–∫–∏ –ø–∞—Ä–æ–ª–µ–π)

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```typescript
import { supabase } from '@/lib/supabase'

// Sign Up
const { data, error } = await supabase.auth.signUp({
  email: 'user@example.com',
  password: 'secure-password-123',
  options: {
    emailRedirectTo: 'https://legacywords.co.uk/onboarding',
    data: {
      full_name: 'John Smith',
      age_range: '55-64'
    }
  }
})
```

#### –í—Ö–æ–¥
```typescript
// Sign In
const { data, error } = await supabase.auth.signInWithPassword({
  email: 'user@example.com',
  password: 'secure-password-123'
})
```

#### –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
```typescript
// Password Reset
const { data, error } = await supabase.auth.resetPasswordForEmail(
  'user@example.com',
  {
    redirectTo: 'https://legacywords.co.uk/reset-password'
  }
)
```

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- ‚úÖ –î–ª—è Memory Keeper: **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø** –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ 45-75 –ª–µ—Ç (–ø—Ä–∏–≤—ã—á–Ω–µ–µ —á–µ–º magic links)
- ‚úÖ –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å

---

## üîó –ú–ï–¢–û–î 2: MAGIC LINK (Passwordless)

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç email, –ø–æ–ª—É—á–∞–µ—Ç –ø–∏—Å—å–º–æ —Å–æ —Å—Å—ã–ª–∫–æ–π. –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å—Å—ã–ª–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Ö–æ–¥–∏—Ç –≤ —Å–∏—Å—Ç–µ–º—É. **–ë–µ–∑ –ø–∞—Ä–æ–ª—è!**

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
- ‚úÖ –ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ (–Ω–µ—Ç –ø–∞—Ä–æ–ª–µ–π –¥–ª—è —É—Ç–µ—á–∫–∏)
- ‚úÖ –ü—Ä–æ—â–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–¥–∏–Ω –∫–ª–∏–∫)
- ‚úÖ –ú–µ–Ω—å—à–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–Ω–µ—Ç "–∑–∞–±—ã–ª –ø–∞—Ä–æ–ª—å")

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ email –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ö–æ–¥–∞
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∑–Ω–∞–∫–æ–º–æ –ø–æ–∂–∏–ª—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- ‚ö†Ô∏è –°—Å—ã–ª–∫–∏ –∏—Å—Ç–µ–∫–∞—é—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è)

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

#### –û—Ç–ø—Ä–∞–≤–∫–∞ Magic Link
```typescript
// Sign In with Magic Link
const { data, error } = await supabase.auth.signInWithOtp({
  email: 'user@example.com',
  options: {
    emailRedirectTo: 'https://legacywords.co.uk/dashboard',
    shouldCreateUser: true // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
  }
})
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ –ø–æ —Å—Å—ã–ª–∫–µ
```typescript
// –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /auth/callback –∏–ª–∏ –ø–æ—Å–ª–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
// Supabase –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏–∑ URL
// –ü—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Å—Å–∏—é:
const { data: { session } } = await supabase.auth.getSession()
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ email —à–∞–±–ª–æ–Ω–∞

–í Supabase Dashboard ‚Üí Email Templates ‚Üí Magic Link:

```html
<h2>–í–æ–π–¥–∏—Ç–µ –≤ Memory Keeper</h2>
<p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Å—ã–ª–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –≤–æ–π—Ç–∏ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç:</p>
<p><a href="{{ .ConfirmationURL }}">–í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç</a></p>
<p>–ò–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥: {{ .Token }}</p>
<p>–°—Å—ã–ª–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 1 —á–∞—Å–∞.</p>
```

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- ‚úÖ –ö–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–Ω–∞—Ä—è–¥—É —Å password)
- ‚úÖ –î–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è UX (–º–µ–Ω—å—à–µ –ø–æ–ª–µ–π –≤ —Ñ–æ—Ä–º–µ)

---

## üî¢ –ú–ï–¢–û–î 3: OTP (One-Time Password)

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç email, –ø–æ–ª—É—á–∞–µ—Ç –ø–∏—Å—å–º–æ —Å **6-–∑–Ω–∞—á–Ω—ã–º –∫–æ–¥–æ–º**. –í–≤–æ–¥–∏—Ç –∫–æ–¥ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è –≤—Ö–æ–¥–∞. **–ë–µ–∑ –ø–∞—Ä–æ–ª—è!**

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
- ‚úÖ –ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (–∫–æ–¥ –º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å)
- ‚úÖ –ó–Ω–∞–∫–æ–º–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (–∫–∞–∫ 2FA)

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ email –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ö–æ–¥–∞
- ‚ö†Ô∏è –î–≤–∞ —à–∞–≥–∞ (–ø–æ–ª—É—á–∏—Ç—å –∫–æ–¥ + –≤–≤–µ—Å—Ç–∏ –∫–æ–¥)
- ‚ö†Ô∏è –ö–æ–¥—ã –∏—Å—Ç–µ–∫–∞—é—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è)

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

#### –®–∞–≥ 1: –û—Ç–ø—Ä–∞–≤–∫–∞ OTP
```typescript
// –û—Ç–ø—Ä–∞–≤–∏—Ç—å OTP –∫–æ–¥
const { data, error } = await supabase.auth.signInWithOtp({
  email: 'user@example.com',
  options: {
    shouldCreateUser: true
  }
})

// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–∫–∞–∂–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è –≤–≤–æ–¥–∞ –∫–æ–¥–∞
```

#### –®–∞–≥ 2: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è OTP
```typescript
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
const { data, error } = await supabase.auth.verifyOtp({
  email: 'user@example.com',
  token: '123456', // –∫–æ–¥ –∏–∑ email
  type: 'email'
})

if (data.session) {
  // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –≤–æ—à–µ–ª
  router.push('/dashboard')
}
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ email —à–∞–±–ª–æ–Ω–∞

–í Supabase Dashboard ‚Üí Email Templates ‚Üí Magic Link (–∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ OTP):

```html
<h2>–ö–æ–¥ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ Memory Keeper</h2>
<p>–í–∞—à –∫–æ–¥ –¥–ª—è –≤—Ö–æ–¥–∞:</p>
<h1 style="font-size: 32px; letter-spacing: 8px;">{{ .Token }}</h1>
<p>–í–≤–µ–¥–∏—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—Ö–æ–¥–∞.</p>
<p>–ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ 1 —á–∞—Å–∞.</p>
```

**–í–∞–∂–Ω–æ:** OTP –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ —à–∞–±–ª–æ–Ω —á—Ç–æ –∏ Magic Link. –ü—Ä–æ—Å—Ç–æ –≤–∫–ª—é—á–∏—Ç–µ `{{ .Token }}` –≤ —à–∞–±–ª–æ–Ω –≤–º–µ—Å—Ç–æ —Å—Å—ã–ª–∫–∏.

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- ‚úÖ –ö–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
- ‚úÖ –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ö–æ–≥–¥–∞ Magic Link –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç (–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ email —Ñ–∏–ª—å—Ç—Ä—ã)

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø –î–õ–Ø MEMORY KEEPER

### –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥**

#### –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥: **Email + Password** ‚úÖ
- –ü—Ä–∏–≤—ã—á–µ–Ω –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ (45-75 –ª–µ—Ç)
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ email –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ö–æ–¥–∞
- –ü—Ä–æ—â–µ –¥–ª—è –ø–æ–∂–∏–ª—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥: **Magic Link** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É
- –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª–∏
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–í–æ–π—Ç–∏ –±–µ–∑ –ø–∞—Ä–æ–ª—è"

### UI/UX –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –í–æ–π—Ç–∏ –≤ Memory Keeper         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                  ‚îÇ
‚îÇ  [Email + Password]              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ Email: [____________]    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ Password: [________]    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ [ ] –ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è      ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ  [–í–æ–π—Ç–∏]                         ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –∏–ª–∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ         ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ  [Magic Link - –±–µ–∑ –ø–∞—Ä–æ–ª—è]      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ Email: [____________]    ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ  [–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É]              ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ  [–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?]                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ê –í SUPABASE

### 1. –í–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ –º–µ—Ç–æ–¥—ã –≤–∫–ª—é—á–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤:
**Supabase Dashboard ‚Üí Authentication ‚Üí Providers ‚Üí Email**

```
‚úÖ Enable Email provider: ON
‚úÖ Confirm email: ON (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
‚úÖ Secure email change: ON
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SMTP (–¥–ª—è production)

**–í–∞–∂–Ω–æ:** –î–ª—è production –Ω—É–∂–µ–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π SMTP!

#### –í–∞—Ä–∏–∞–Ω—Ç—ã SMTP –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤:

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | Free Tier | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|-----------|-----------|--------------|
| **Resend** | 3,000 emails/–º–µ—Å—è—Ü | ‚úÖ –õ—É—á—à–∏–π –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ |
| **SendGrid** | 100 emails/–¥–µ–Ω—å | ‚úÖ –•–æ—Ä–æ—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç |
| **Postmark** | 100 emails/–º–µ—Å—è—Ü | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π free tier |
| **AWS SES** | 62,000 emails/–º–µ—Å—è—Ü | ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π |

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Resend (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ [resend.com](https://resend.com)
2. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á
3. –í Supabase Dashboard ‚Üí Settings ‚Üí Auth ‚Üí SMTP Settings:

```
SMTP Host: smtp.resend.com
SMTP Port: 465 (–∏–ª–∏ 587)
SMTP User: resend
SMTP Password: [–≤–∞—à API –∫–ª—é—á]
Sender Email: no-reply@legacywords.co.uk
Sender Name: Memory Keeper
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ email —à–∞–±–ª–æ–Ω–æ–≤

**Supabase Dashboard ‚Üí Authentication ‚Üí Email Templates**

–ú–æ–∂–Ω–æ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å:
- ‚úÖ –¢–µ–∫—Å—Ç –ø–∏—Å–µ–º
- ‚úÖ HTML –¥–∏–∑–∞–π–Ω
- ‚úÖ –ë—Ä–µ–Ω–¥–∏–Ω–≥ (–ª–æ–≥–æ—Ç–∏–ø, —Ü–≤–µ—Ç–∞)
- ‚úÖ –Ø–∑—ã–∫ (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π –¥–ª—è Memory Keeper)

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ URL —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤

**Supabase Dashboard ‚Üí Authentication ‚Üí URL Configuration**

```
Site URL: https://legacywords.co.uk
Redirect URLs:
  - https://legacywords.co.uk/dashboard
  - https://legacywords.co.uk/onboarding
  - https://legacywords.co.uk/auth/callback
```

---

## üîê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

### Rate Limits (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

| –ú–µ—Ç–æ–¥ | –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ | –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è |
|-------|----------------|-----------------|
| Magic Link | 1 —Ä–∞–∑ –≤ 60 —Å–µ–∫—É–Ω–¥ | 1 —á–∞—Å |
| OTP | 1 —Ä–∞–∑ –≤ 60 —Å–µ–∫—É–Ω–¥ | 1 —á–∞—Å |
| Password Reset | 1 —Ä–∞–∑ –≤ 60 —Å–µ–∫—É–Ω–¥ | 1 —á–∞—Å |

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤: **Auth ‚Üí Rate Limits**

### Email Verification

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** –¢—Ä–µ–±–æ–≤–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º.

```typescript
// –í Supabase Dashboard ‚Üí Auth ‚Üí Settings
Email Confirmation: ON
```

–≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Å —á—É–∂–∏–º–∏ email
- ‚úÖ –°–ø–∞–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–±–ª–µ–º—ã —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é

### CAPTCHA (–∑–∞—â–∏—Ç–∞ –æ—Ç –±–æ—Ç–æ–≤)

–î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å CAPTCHA:
**Supabase Dashboard ‚Üí Auth ‚Üí Providers ‚Üí Email ‚Üí CAPTCHA**

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:
- ‚úÖ Google reCAPTCHA v3
- ‚úÖ hCaptcha
- ‚úÖ Cloudflare Turnstile

---

## üí∞ –°–¢–û–ò–ú–û–°–¢–¨

### Supabase Auth (–≤—Ö–æ–¥–∏—Ç –≤ Supabase)

**Free Tier:**
- ‚úÖ 50,000 MAU (Monthly Active Users)
- ‚úÖ Unlimited API requests
- ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ Email templates
- ‚úÖ **$0/–º–µ—Å—è—Ü**

**Pro Plan ($25/–º–µ—Å—è—Ü):**
- 100,000 MAU
- Custom SMTP (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –Ω–∞ free tier)
- Advanced features

### SMTP –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

**Resend (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
- Free: 3,000 emails/–º–µ—Å—è—Ü
- Pro: $20/–º–µ—Å—è—Ü (50,000 emails)

**SendGrid:**
- Free: 100 emails/–¥–µ–Ω—å
- Essentials: $19.95/–º–µ—Å—è—Ü (50,000 emails)

**–ò—Ç–æ–≥–æ –¥–ª—è Memory Keeper:**
- 0-1,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: **$0/–º–µ—Å—è—Ü** (Supabase free + Resend free)
- 1,000-5,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: **$20/–º–µ—Å—è—Ü** (Resend Pro)
- 5,000+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: **$25-45/–º–µ—Å—è—Ü** (Supabase Pro + Resend)

---

## üìù –ü–†–ò–ú–ï–† –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Sign In —Å –≤—ã–±–æ—Ä–æ–º –º–µ—Ç–æ–¥–∞

```typescript
// app/sign-in/page.tsx
'use client'

import { useState } from 'react'
import { supabase } from '@/lib/supabase'
import { useRouter } from 'next/navigation'

export default function SignInPage() {
  const [method, setMethod] = useState<'password' | 'magic-link'>('password')
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const router = useRouter()

  // Email + Password
  const handlePasswordSignIn = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    
    const { data, error } = await supabase.auth.signInWithPassword({
      email,
      password
    })
    
    if (error) {
      alert(error.message)
    } else {
      router.push('/dashboard')
    }
    
    setLoading(false)
  }

  // Magic Link
  const handleMagicLinkSignIn = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    
    const { error } = await supabase.auth.signInWithOtp({
      email,
      options: {
        emailRedirectTo: `${window.location.origin}/dashboard`
      }
    })
    
    if (error) {
      alert(error.message)
    } else {
      alert('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ email –¥–ª—è –≤—Ö–æ–¥–∞!')
    }
    
    setLoading(false)
  }

  return (
    <div className="min-h-screen flex items-center justify-center">
      <div className="w-full max-w-md">
        <h1>–í–æ–π—Ç–∏ –≤ Memory Keeper</h1>
        
        {/* Tabs –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–µ—Ç–æ–¥–∞ */}
        <div className="flex gap-4 mb-6">
          <button
            onClick={() => setMethod('password')}
            className={method === 'password' ? 'active' : ''}
          >
            Email + Password
          </button>
          <button
            onClick={() => setMethod('magic-link')}
            className={method === 'magic-link' ? 'active' : ''}
          >
            Magic Link
          </button>
        </div>

        {/* –§–æ—Ä–º–∞ */}
        {method === 'password' ? (
          <form onSubmit={handlePasswordSignIn}>
            <input
              type="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              placeholder="Email"
              required
            />
            <input
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              placeholder="Password"
              required
            />
            <button type="submit" disabled={loading}>
              –í–æ–π—Ç–∏
            </button>
          </form>
        ) : (
          <form onSubmit={handleMagicLinkSignIn}>
            <input
              type="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              placeholder="Email"
              required
            />
            <button type="submit" disabled={loading}>
              –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É
            </button>
          </form>
        )}

        <a href="/sign-up">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
        <a href="/forgot-password">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
      </div>
    </div>
  )
}
```

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –î–õ–Ø –ó–ê–ü–£–°–ö–ê

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase Auth

- [ ] –í–∫–ª—é—á–∏—Ç—å Email provider –≤ Dashboard
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP (Resend –∏–ª–∏ –¥—Ä—É–≥–æ–π)
- [ ] –ö–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å email —à–∞–±–ª–æ–Ω—ã
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å URL —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã
- [ ] –í–∫–ª—é—á–∏—Ç—å email verification
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å rate limits (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –í–∫–ª—é—á–∏—Ç—å CAPTCHA (–¥–ª—è production)

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É Sign Up
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É Sign In (—Å –≤—ã–±–æ—Ä–æ–º –º–µ—Ç–æ–¥–∞)
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É Forgot Password
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É Reset Password
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É Email Verification
- [ ] –û–±–Ω–æ–≤–∏—Ç—å middleware –¥–ª—è –∑–∞—â–∏—Ç—ã routes
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `getCurrentUserId()` –≤ `lib/api.ts`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–µ—Ç–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å email + password
- [ ] –í—Ö–æ–¥ —Å email + password
- [ ] Magic Link –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏ –≤—Ö–æ–¥
- [ ] OTP –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
- [ ] –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
- [ ] Email verification
- [ ] RLS –ø–æ–ª–∏—Ç–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìö –†–ï–°–£–†–°–´

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Supabase
- [Email Auth Guide](https://supabase.com/docs/guides/auth/passwords)
- [Magic Link Guide](https://supabase.com/docs/guides/auth/auth-email-passwordless)
- [Email Templates](https://supabase.com/docs/guides/auth/auth-email-templates)
- [SMTP Setup](https://supabase.com/docs/guides/auth/auth-smtp)

### –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã SMTP
- [Resend](https://resend.com) - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
- [SendGrid](https://sendgrid.com)
- [Postmark](https://postmarkapp.com)

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** –Ø–Ω–≤–∞—Ä—å 2025  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP –∏ —Å–æ–∑–¥–∞—Ç—å UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

